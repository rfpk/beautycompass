if($('#viewChatBC').length){
    $('#viewChatBC').pagination({
        dataSource: [
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'bing',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'unlock-icon',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'bing',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'unlock-icon',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            {
                nameUserProgram: 'Ник, весна 2025',
                date:'№ 876324876239847 от 22.08.2022',
                statusChat:'',
                descriptProgram: 'Причина обращения: Программа для сухой кожи на весну. Дополнительные решаемые задачи: потеря упругости, гиперпигментация'
            },
            
        ],
        pageSize: 10,
        pageNumber: 1,
        pageRange: 0,
        callback: function(data, pagination) {
            var html = templatingItem(data);
            $('#viewChatBC').prev().html(html);
        }
    });
}

if($('#view_chats').length){
    $('#view_chats').pagination({
        dataSource: [
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
            {
                nameUserProgram: 'Ник, длииииииииииииииинное ',
                date:'22.08.2022',
                avatar: 'user-avatar.svg',
                idUser:'1',
                nameUser:'Дарья С.',
                prevLastMess:' Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore'
            },
        ],
        pageSize: 10,
        pageNumber: 1,
        pageRange: 0,
        callback: function(data, pagination) {
            var html = templatingItemPerson(data);
            $('#view_chats').prev().html(html);
        }
    })
}

function templatingItem(data) {
    html = '<ul>';
    data.forEach(element => {
        html += '<li class="">        <a href="#'
        if(element.statusChat=='unlock-icon'){
            html+='?lock'
        }
        html+= '" class="d-flex justify-content-between align-items-center '
        if(element.statusChat=='unlock-icon'){
            html+='unlock-icon'
        }
        html+=' "> <div class="infProg"> <p class="title '
        if(element.statusChat){
            if(element.statusChat=='unlock-icon'){
                html+='unlock-icon'
            }
            else if(element.statusChat=='bing')
                html+='bing'
        }
        html+='">'+element.nameUserProgram+'</p> <small>'+element.date+'</small>'
        if(element.descriptProgram!=undefined){
            html+= '<p class="descr">'+element.descriptProgram+'</p>'
        }
        html+='</div></a> </li>';
    });
    html += '</ul>';

    return html;
}

function templatingItemPerson(data) {
    
    html = '<ul>'
    data.forEach(element => {
        html +='<div class="feed__row"><div class="feed__user"><a href="#" class="feed__avatar-chats"><img src="'

        html+='../img/'+element.avatar
        
        html+='" alt="avatar" /></a>  <div> <div class="feed__info">' 
        html+='<div class="d-flex align-items-center gap-2">'

        html+='<a href="#" class="feed__avatar feed__avatar-chats"><img src="'

        html+='../img/'+element.avatar
        
        html+='" alt="avatar" /></a>'

        html+='<a href="#" class="feed__name">'
        
        html+=element.nameUser

        html+='</a><div class="feed__date">'

        html+= element.date

        html+='</div> </div> </div> <p class="feed__text feed__text-chats mt-3">'

        html+=element.prevLastMess

        html+='</p> </div> </div> </div>'
    });
    html += '</ul>'

    return html;
}

$('.send-mess-tech input#form__pic.file-input').on("change", null, $('#form__pic'), handleFileSelected)
function handleFileSelected(input) {

    var container=$(".previewImage")
    
    while ($('.previewImage #avatar')[0].previousElementSibling) {
        $('.previewImage #avatar')[0].previousElementSibling.remove()
    }

    if(input.data[0])
        file = input.data[0].files
    else
        file = input[0].files
    
    if(file.length!=0){
        $('.send-mess-tech .previewImage_text').css('display','none')
        if(window.innerWidth>1440){
            $('.send-mess-tech .previewImage').css('justify-content','start')
        }
        $('.send-mess-tech .previewImage').css('flex-direction','row')
        $('.send-mess-tech .previewImage').css('flex-wrap','wrap')

        for (let index = 0; index < file.length; index++) {
            if (index == 5) {
                break;
            }
            const element = file[index];
            if(element.size<=8388608){
                let reader = new FileReader()
                reader.readAsDataURL(element)
                reader.onload = function () {
                    html='<div class="visDestr"><div id="image_'+index+'"' 
                    html+='class="delImage addImage" '
                    html+='style="background-image:url('+reader.result+'); "></div></div>'
                    output=$(html)
                    output.on('click', delImg)
                    container[0].prepend(output[0]);
                    
                }
            }
        }
}

}

function delImg(image){
    this.remove()
    if($('.previewImage #avatar')[0].previousElementSibling==null){
        $('.send-mess-tech .previewImage_text').css('display','block')
        if(window.innerWidth<=1440){
            $('.send-mess-tech .previewImage').css('justify-content','center')
            $('.send-mess-tech .previewImage').css('flex-direction','column')
        }else{
            $('.send-mess-tech .previewImage').css('flex-direction','row')
        }

    }
    
    event.preventDefault()
}

$('#sendMess .tech .sendMess').on('click', function() {
    console.log('отправка сообщения на сервер техн поддержки');

    $.ajax({
        type: "post",
        url: "#",
        data: $('.send-mess-tech').serialize() ,
        dataType: "dataType",
        success: function (response) {
            console.log('успех');
        }
    });

    $('#sendMess').modal('toggle');
})
$('#sendMess .tech .sendMess-chats').on('click', function() {
    console.log('отправка сообщения на сервер чатов');

    $.ajax({
        type: "post",
        url: "#",
        data: $('.send-mess-tech').serialize() ,
        dataType: "dataType",
        success: function (response) {
            console.log('успех');
        }
    });

    $('#sendMess').modal('toggle');
})
$('.send-mess-tech #adrese button').on('click', function(params) {
    event.preventDefault();
    $('.send-mess-tech #adrese .form-control').focus();
})

$('.send-mess-tech #adrese .form-control').on('keyup',function (params) {

    if(params.target.value=='' || params.target.value==null){
        $('.modal__adrese__ansver').css('display', 'none')
        $('.send-mess-tech #adrese .form-control').css('padding-left', '43px')
        $('.send-mess-tech #adrese button').css('display','block')
    }
    else{

        //раскомментировать когда прийдет время
        // $.ajax({
        //     type: "post",
        //     url: "url",
        //     data: params.target.value,
        //     dataType: "dataType",
        //     success: function (response) {
        //         $('.modal__adrese__ansver').css('display', 'block')

        //         response.forEach(element => {
        //             let html='<div class="modal__adrese"><p class="modal__adrese__text">'
        //             html+= element.nameUser
        //             html+='</p></div> '
        //             $('.modal__adrese__ansver').appendChild(html);

        //         });
        //     }
        // });

        //удалить при появлении серверной части
        $('.modal__adrese__ansver').css('display', 'block')
        $('.send-mess-tech #adrese button').css('display','none')
        $('.send-mess-tech #adrese .form-control').css('padding-left', '.75rem')
    }
})

$('.modal__adrese__ansver').on('click',null, $('.modal__adrese'), function(params) {
    $('.send-mess-tech #adrese .form-control')[0].value=params.target.innerText
    $('.send-mess-tech #adrese .form-control').css('padding-left', '43px')
    $('.send-mess-tech #adrese button').css('display','block')
    $('.modal__adrese__ansver').css('display', 'none')
})